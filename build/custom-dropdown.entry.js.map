{"file":"custom-dropdown.entry.esm.js","mappings":"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","names":[],"sources":["src/utils/debounce.ts","src/components/custom-dropdown/custom-dropdown.css?tag=custom-dropdown&encapsulation=shadow","src/components/custom-dropdown/custom-dropdown.tsx"],"sourcesContent":["export const debounce = (fn: Function, delay: number) => {\n  let timeoutId: ReturnType<typeof setTimeout> | null = null;\n  return function (...args: any[]) {\n    if (timeoutId) {\n      clearTimeout(timeoutId);\n    }\n    timeoutId = setTimeout(() => {\n      fn(...args);\n      timeoutId = null;\n    }, delay);\n  };\n}\n",":host {\n  font-family: Helvetica, sans-serif;\n  display: block;\n  max-width: 24rem;\n  color: var(--custom-dropdown-font-color, #767676);\n  font-weight: var(--custom-dropdown-font-weight, 700);\n}\n\nform {\n  position: relative;\n}\n\nlabel {\n  display: block;\n  margin-bottom: .5rem;\n}\n\n.search {\n  padding: .5rem 1rem;\n  width: 100%;\n  box-sizing: border-box;\n  font-size: 1rem;\n  background-color: var(--custom-dropdown-background-color, #F5F5F7);\n  color: var(--custom-dropdown-font-color, #767676);\n  font-weight: var(--custom-dropdown-font-weight, 700);\n  border: none;\n}\n\n.search-wrapper {\n  position: relative;\n  background: none;\n  border: none;\n  width: 100%;\n  background-color: var(--custom-dropdown-background-color, #F5F5F7);\n}\n\n.search-wrapper::before {\n  content: 'â–¼';\n  position: absolute;\n  right: .8rem;\n  top: 50%;\n  transform: translateY(-50%);\n}\n\n.options {\n  position: absolute;\n  left: 0;\n  right: 0;\n  padding: 0;\n  margin: 0;\n  overflow-y: auto;\n  list-style-type: none;\n  transform: scale(1, 0);\n  transform-origin: top left;\n  transition: all 150ms ease-in;\n  pointer-events: none;\n  z-index: 2;\n}\n\n.options.active {\n  opacity: 1;\n  transform: scale(1, 1);\n  pointer-events: auto;\n}\n","import { Component, h, ComponentInterface, Host, Prop, State, Listen, Element, Event, EventEmitter } from '@stencil/core';\nimport { debounce } from '../../utils/debounce';\nimport { Option } from '../../utils/models';\n\n/**\n * Custom dropdown component with built in optional search. Should be used along with custom-option components simiarly\n * to the native browser select element\n */\n@Component({\n  tag: 'custom-dropdown',\n  styleUrl: 'custom-dropdown.css',\n  shadow: true,\n})\nexport class CustomDropdown implements ComponentInterface {\n  /**\n   * Label above the dropdown\n   */\n  @Prop() label: string;\n\n  itemContainerRef!: HTMLUListElement;\n\n  /**\n   * Whether or not the dropdown is open\n   */\n  @State() active: boolean = false;\n\n  /**\n   * Value of the dropdown\n   */\n  @State() selectedOption: Option = null;\n\n  /**\n   * The value of the input\n   */\n  @State() filter: string = '';\n\n  @Element() el: HTMLElement;\n\n  /**\n   * Fires whenever the value of the dropdown changes\n   */\n  @Event() changeDropdown: EventEmitter<string>;\n\n  /**\n   * Time in milliseconds to debounce the handleChangeFilterDebounced\n   */\n  private filterDebounceMs = 200;\n\n  componentDidLoad() {\n    this.updateOptionVisibility(this.filter);\n  }\n\n  @Listen('focus')\n  handleFocus() {\n    this.toggleDropdown();\n  }\n\n  @Listen('click')\n  handleClick(event: MouseEvent) {\n    if (event.target instanceof customElements.get('custom-option')) {\n      const option = event.target as HTMLCustomOptionElement;\n      this.selectedOption = { value: option.value, label: option.innerHTML };\n      this.updateOption();\n      this.toggleDropdown();\n    }\n  }\n\n  @Listen('click', { target: 'document' })\n  handleDocumentClick(event: MouseEvent) {\n    if (!this.active) {\n      return;\n    }\n    if (!this.el.contains(event.target as Node)) {\n      this.changeActiveState(false);\n    }\n  }\n\n  private updateOption = () => {\n    const options = this.getVisibleOptions();\n    const optEl = options.find(o => document.activeElement === o);\n    this.selectedOption = optEl ? { value: optEl.value, label: optEl.innerHTML } : this.selectedOption;\n    this.changeDropdown.emit(this.selectedOption ? this.selectedOption.value : '');\n  };\n\n  getAllOptions = () => Array.from(this.el.querySelectorAll('custom-option'));\n\n  getVisibleOptions = () => Array.from(this.el.querySelectorAll('custom-option.visible') as NodeListOf<HTMLCustomOptionElement>);\n\n  setOptionFocus = (option: Option | HTMLCustomOptionElement) => {\n    const optEl = 'label' in option ? this.getVisibleOptions().find(o => o.value === option.value) : option;\n    const li = optEl?.shadowRoot.querySelector('li');\n    li?.focus();\n  };\n\n  focusSelectedOption = () => {\n    if (this.selectedOption) {\n      this.setOptionFocus(this.selectedOption);\n    } else {\n      this.focusNextOption();\n    }\n  };\n\n  focusNextOption = () => {\n    if (!this.active) {\n      this.changeActiveState(true);\n    }\n    const options = this.getVisibleOptions();\n    const index = options.findIndex(o => document.activeElement === o);\n    const option = index === options.length - 1 ? options[0] : options[index + 1];\n    this.setOptionFocus(option);\n  };\n\n  focusPrevOption = () => {\n    if (!this.active) {\n      this.changeActiveState(true);\n    }\n    const options = this.getVisibleOptions();\n    const index = options.findIndex(o => document.activeElement === o);\n    const option = index === 0 || index === -1 ? options[options.length - 1] : options[index - 1];\n    this.setOptionFocus(option);\n  };\n\n  private changeActiveState = (active: boolean) => {\n    if (!this.active) {\n      this.el.shadowRoot.querySelector('input').focus();\n    }\n    if (!active) {\n      this.el.focus();\n    }\n    this.active = active;\n  };\n\n  private toggleDropdown = () => {\n    const active = !this.active;\n    this.changeActiveState(active);\n  };\n\n  @Listen('keydown')\n  handleKeyDown(event: KeyboardEvent) {\n    switch (event.key) {\n      case 'Enter':\n      case ' ':\n        event.preventDefault();\n        if (this.active) {\n          this.updateOption();\n        }\n        this.toggleDropdown();\n        if (this.selectedOption) {\n          this.focusSelectedOption();\n        }\n        break;\n      case 'Escape':\n        if (this.active) {\n          this.changeActiveState(false);\n          this.updateFilter(this.selectedOption ? this.selectedOption.label : this.filter);\n        }\n        break;\n      case 'ArrowDown':\n        event.preventDefault();\n        this.focusNextOption();\n        break;\n      case 'ArrowUp':\n        event.preventDefault();\n        this.focusPrevOption();\n        break;\n    }\n  }\n\n  updateFilter = (value: string) => {\n    this.filter = value;\n    this.handleChangeFilterDebounced(this.filter);\n  };\n\n  optionIsVisible = (filter: string, option: HTMLCustomOptionElement) =>\n    filter === '' || option.innerHTML.toLowerCase().includes(filter);\n\n  updateOptionVisibility = (filter: string) => {\n    const options = this.getAllOptions();\n    options.forEach(option => {\n      if (this.optionIsVisible(filter, option)) {\n        option.classList.add('visible');\n      } else {\n        option.classList.remove('visible');\n      }\n    });\n  };\n\n  handleChangeFilterDebounced = debounce((filter: string) => {\n    this.updateOptionVisibility(filter);\n  }, this.filterDebounceMs);\n\n  handleInput = (event: Event) => {\n    const target = event.target as HTMLInputElement;\n    const value = target.value;\n    this.updateFilter(value);\n  };\n\n  render() {\n    return (\n      <Host>\n        <form>\n          <label htmlFor={this.label}>{this.label}</label>\n          <div class=\"search-wrapper\">\n            <input\n              class=\"search\"\n              type=\"text\"\n              placeholder=\"Select\"\n              id={this.label}\n              role=\"combobox\"\n              aria-controls={`listbox-${this.label}`}\n              aria-haspopup={`listbox-${this.label}`}\n              tabindex=\"0\"\n              aria-expanded={this.active.toString()}\n              onInput={this.handleInput}\n              value={this.selectedOption?.label || this.filter}\n            />\n          </div>\n          <ul class={`options${this.active ? ' active' : ''}`} role=\"listbox\" id={`listbox-${this.label}`}>\n            <slot></slot>\n          </ul>\n        </form>\n      </Host>\n    );\n  }\n}\n"],"version":3}